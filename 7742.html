<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SevenKnights2Redeem mass code</title><!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=GTM-WH4M38Q"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        gtag('config', 'GTM-WH4M38Q');
    </script>
</head>

<body>
    <p><span>user id : </span><input type="text" id="uid">
    <button onclick="req();">run</button>
    <a target="_blank" rel="noopener noreferrer" href="https://forum.netmarble.com/sk2_en/view/12/10252"></a></p>
    <hr>
    <div id="example-table"><br></div>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <p>
        <link href="https://unpkg.com/tabulator-tables@4.1.4/dist/css/tabulator.min.css" rel="stylesheet">
    </p>
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.1.4/dist/js/tabulator.min.js"></script>
    <script>
        function setCookie(cookie_name, value, days) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + days);
        
            var cookie_value = escape(value) + ((days == null) ? '' : '; expires=' + exdate.toUTCString());
            document.cookie = cookie_name + '=' + cookie_value;
        }
        
        function getCookie(cookie_name) {
            var x, y;
            var val = document.cookie.split(';');
        
            for (var i = 0; i < val.length; i++) {
                x = val[i].substr(0, val[i].indexOf('='));
                y = val[i].substr(val[i].indexOf('=') + 1);
                x = x.replace(/^\s+|\s+$/g, '');
                if (x == cookie_name) {
                    return unescape(y);
                }
            }
        
            return null
        }
        
        let uid = getCookie('uid')
        
        if (uid) { $('#uid').val(uid) }
        var tabledata = [
            { id: 1, code: "", result: 0, response: '', description: 'request' },
            /*{ id: 2, code: "", result: 0, response: '', description: 'request' },
            { id: 3, code: "", result: 0, response: '', description: 'request' },
            { id: 4, code: "", result: 0, response: '', description: 'request' },
            { id: 5, code: "", result: 0, response: '', description: 'request' },
            { id: 6, code: "", result: 0, response: '', description: 'request' },
            { id: 7, code: "", result: 0, response: '', description: 'request' },
            { id: 8, code: "", result: 0, response: '', description: 'request' },
            { id: 9, code: "", result: 0, response: '', description: 'request' },
            { id: 10, code: "", result: 0, response: '', description: 'request' },
            { id: 11, code: "", result: 0, response: '', description: 'request' },
            { id: 12, code: "", result: 0, response: '', description: 'request' },
            { id: 13, code: "", result: 0, response: '', description: 'request' },
            { id: 14, code: "", result: 0, response: '', description: 'request' },
            { id: 15, code: "", result: 0, response: '', description: 'request' },
            { id: 16, code: "", result: 0, response: '', description: 'request' },
            { id: 17, code: "", result: 0, response: '', description: 'request' },
            { id: 18, code: "", result: 0, response: '', description: 'request' },
            { id: 19, code: "", result: 0, response: '', description: 'request' },
            { id: 20, code: "", result: 0, response: '', description: 'request' },
            { id: 21, code: "", result: 0, response: '', description: 'request' },
            { id: 22, code: "", result: 0, response: '', description: 'request' },
            { id: 23, code: "", result: 0, response: '', description: 'request' },
            { id: 24, code: "", result: 0, response: '', description: 'request' },
            { id: 25, code: "", result: 0, response: '', description: 'request' },
            { id: 26, code: "", result: 0, response: '', description: 'request' },
            { id: 27, code: "", result: 0, response: '', description: 'request' },
            { id: 28, code: "", result: 0, response: '', description: 'request' },
            { id: 29, code: "", result: 0, response: '', description: 'request' },
            { id: 30, code: "", result: 0, response: '', description: 'request' },
            { id: 31, code: "", result: 0, response: '', description: 'request' },
            { id: 32, code: "", result: 0, response: '', description: 'request' },
            { id: 33, code: "", result: 0, response: '', description: 'request' },
            { id: 34, code: "", result: 0, response: '', description: 'request' },
            { id: 35, code: "", result: 0, response: '', description: 'request' },
            { id: 36, code: "", result: 0, response: '', description: 'request' },
            { id: 37, code: "", result: 0, response: '', description: 'request' },
            { id: 38, code: "", result: 0, response: '', description: 'request' },
            { id: 39, code: "", result: 0, response: '', description: 'request' },
            { id: 40, code: "", result: 0, response: '', description: 'request' },
            { id: 41, code: "", result: 0, response: '', description: 'request' },
            { id: 42, code: "", result: 0, response: '', description: 'request' },
            { id: 43, code: "", result: 0, response: '', description: 'request' },
            { id: 44, code: "", result: 0, response: '', description: 'request' },
            { id: 45, code: "", result: 0, response: '', description: 'request' },
            { id: 46, code: "", result: 0, response: '', description: 'request' },
            { id: 47, code: "", result: 0, response: '', description: 'request' },
            { id: 48, code: "", result: 0, response: '', description: 'request' },
            { id: 49, code: "", result: 0, response: '', description: 'request' },
            { id: 50, code: "", result: 0, response: '', description: 'request' },*/
        ];
        
        function req() {
            var uid = $('#uid').val()
            setCookie('uid', uid)
            for (var a in tabledata) {
                let i = a
                $.ajax({
                    type: 'post',
		    header: {'Content-Type': 'application/json',Authorization: 'Bearer $('#uid')',Referer: "https://coupon.netmarble.com/sk2gb"},
                    url: 'https://coupon.netmarble.com/api/coupon',
                    data: {
					'gameCode': 'sk2gb',
					'couponCode': tabledata[i]['code'],
					'langCd': 'ZH_TW',
                    			'pid': uid
                    }
                   /* success: function (data) {
		    	$.ajax({
				 contentType : 'application/json',
		   		 type: 'post',
                   		 url: 'https://coupon.netmarble.com/api/coupon',
				 headers: { 'Cookie': '_ga_VTN3M4859L=GS1.1.1651670097.1.0.1651670097.0; _ga_GVE6X9WL91=GS1.1.1658761040.1.0.1658761044.0; _ga_QD6XPNHQ6V=GS1.1.1686151559.23.0.1686151559.0.0.0; _ga_6JCQYRL430=GS1.1.1689511018.1.0.1689511018.0.0.0; _ga_LQ59E03LGJ=GS1.1.1690201188.6.0.1690201195.0.0.0; _ga_GVG0Q2E9P2=GS1.2.1694281466.1.1.1694281512.0.0.0; _ga=GA1.1.369852324.1637850171; _ga_HZ3N7KW97V=GS1.1.1698235785.1.0.1698236058.0.0.0; _ga_CRB86XD2K0=GS1.1.1700667123.32.0.1700667127.0.0.0; _ga_0T1HM45XFQ=GS1.1.1700667123.33.0.1700667127.0.0.0; _ga=GA1.3.369852324.1637850171; NMGameCode=sk2gb; NMGameToken=0AB0012FE2F27221F97EF0A4C02FE36FBDD2082878DC6CE61F31B1730D40C542ECB22C756DAA82D0A803A6C0784A617C85EE15306B3649767211E9B42DB3C79EB43CA16048B8AB0A4D144FA1240BA6DDD95F9DBADC4A95D7D1ED0379D40D85F5103CED5EFC96D5052368A6ED6E75A87658C1259BDCBD8FEC41015EFDE2597CDB56770BC5A00671D66D3AF0039FE81A9899415857B82E1AF72FCA463FC878C7ED1F7EF45D185BE338185C00F708E4BBE825041712203F09D886B65705D23534CE3ED557A2D044B90A97256CB5709BE3595B4B000C56; NMJoinedCountryCode=TW; NMLanguage=zh-TW; NMDeviceLanguage=zh-TW; NMPlatform=PC; NMPlayerID=477B5DC3329C4728943EB88A586AAC08; _ga_3MC57P48VK=GS1.3.1711593904.12.0.1711593905.0.0.0' , 'Origin': 'https://coupon.netmarble.com/' ,'Referer': 'https://coupon.netmarble.com/sk2gb' },
                   		 data: {
                    			'gameCode': 'sk2gb',
                  			'couponCode': tabledata[i]['code'],
                  			'langCd': 'ZH_TW',
                               		'pid': uid
                    		}*/
                    	})
		    }
                })
            }
        }
        
      /*  google.charts.load('current', { packages: ['corechart'] }).then(function () {
            var query = new google.visualization.Query('https://spreadsheets.google.com/tq?tqx=out:html&tq=SELECT+B,D&key=13SWidGIeegH0otFPVD6KkaXcUbJ6MpKoQlX9QxPCscc&gid=315323999');
            query.send(function (response) {
                var dataTable = response.getDataTable();
                var jsonData = dataTable.toJSON();
                jsonData = JSON.parse(jsonData);
                for (var i = 0; i < jsonData.rows.length; i++) {
                    var htmlData = jsonData.rows[i].c[0].v;
                    var htmlDate = jsonData.rows[i].c[1].v;
                    tabledata[i]['code'] = htmlData;
                    if (htmlDate != "") {
        						$('#datediv span').text(htmlDate + " : ~" + (i + 1) + " add");
                    }
                    table.updateData(tabledata);
                }
        
            });
        });*/
        
        var table = new Tabulator("#example-table", {
            data: tabledata,           //load row data from array
            reactiveData: true,
            layout: "fitDataFill",      //fit columns to width of table
            responsiveLayout: "hide",  //hide columns that dont fit on the table
            tooltips: true,            //show tool tips on cells
            addRowPos: "top",          //when adding a new row, add it to the top of the table
            history: true,             //allow undo and redo actions on the table
            movableColumns: true,      //allow column order to be changed
            resizableRows: true,       //allow row order to be changed
            columns: [                 //define the table columns
                { title: "No", field: "id", width: 70, editor: false },
                { title: "Code", field: "code", width: 300, editor: "input" },
                {
                    title: "status",
                    field: "result",
                    width: 90,
                    hozAlign: "center",
                    formatter: "tickCross",
                    sorter: "boolean",
                    editor: false
                },
                { title: "response", field: "response", width: 180, editor: false },
                { title: "exp", field: "description", width: 300, editor: false },
            ],
        });
    </script>

</body>

</html>
